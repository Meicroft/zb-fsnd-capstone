<html>
  <head>
    <title>Movies Page</title>
    <link rel="stylesheet" href="/css/style.css" type="text/css">
  </head>
  <body>
    <h1>Movies Page</h1>
    <div>
      <a href="/"><button class="btn btn-primary btn-lg">Back to Home Page</button></a>
      <a href="/actors"><button class="btn btn-default btn-lg">View Our Actors</button></a>
    </div>
      <ul id="movies">
        {% for d in data %}
        <li>
          <form method="get" action="/movies/{{ d.id }}">
            <button class="details-button">Details</button>
          </form>
          {{ d.title }}
          <button class="delete-button" data-id="{{ d.id }}">Delete</button>
        </li>
        {% endfor %}
      </ul>
      <form method="post" action="/movies/create">
          <label>List New Movie</label>
          <div>
            <label for="title">Title</label>
            <input type="text" name="title" />
          </div>
          <div>
            <label for="release_date">Release Date</label>
            <input type="date" name="release_date" />
          </div>
          <div>
            <input type="submit" value="List Movie" />
          </div>
        </form>
      <script>
        const deleteBtns = document.querySelectorAll('.delete-button');
        for (let i = 0; i < deleteBtns.length; i++) {
          const btn = deleteBtns[i];
          btn.onclick = function(e) {
            const movieId = e.target.dataset['id'];
            fetch('/movies/' + movieId, {
              method: 'DELETE'
            })
            .then(function() {
              const item = e.target.parentElement;
              item.remove();
            })
          }
        }
      </script>
  </body>
</html>